import pygmsh 
import meshio 
import numpy as np 
 
geom = pygmsh.opencascade.Geometry() 
 
# mesh size description 
cl = 0.01
 
# Coordinates of Frame 
FrameCoordinates = np.array([[0.00,0.00,0.00],
 [0.01,0.00,0.00],
 [0.02,0.00,0.00],
 [0.03,0.00,0.00],
 [0.04,0.00,0.00],
 [0.05,0.00,0.00],
 [0.06,0.00,0.00],
 [0.07,0.00,0.00],
 [0.08,0.00,0.00],
 [0.09,0.00,0.00],
 [0.10,0.00,0.00],
 [0.11,0.00,0.00],
 [0.12,0.00,0.00],
 [0.13,0.00,0.00],
 [0.14,0.00,0.00],
 [0.15,0.00,0.00],
 [0.16,0.00,0.00],
 [0.17,0.00,0.00],
 [0.18,0.00,0.00],
 [0.19,0.00,0.00],
 [0.20,0.00,0.00],
 [0.21,0.00,0.00],
 [0.22,0.00,0.00],
 [0.23,0.00,0.00],
 [0.24,0.00,0.00],
 [0.25,0.00,0.00],
 [0.26,0.00,0.00],
 [0.27,0.00,0.00],
 [0.28,0.00,0.00],
 [0.29,0.00,0.00],
 [0.30,0.00,0.00],
 [0.31,0.00,0.00],
 [0.32,0.00,0.00],
 [0.33,0.00,0.00],
 [0.34,0.00,0.00],
 [0.35,0.00,0.00],
 [0.36,0.00,0.00],
 [0.37,0.00,0.00],
 [0.38,0.00,0.00],
 [0.39,0.00,0.00],
 [0.40,0.00,0.00],
 [0.41,0.00,0.00],
 [0.42,0.00,0.00],
 [0.43,0.00,0.00],
 [0.44,0.00,0.00],
 [0.45,0.00,0.00],
 [0.46,0.00,0.00],
 [0.47,0.00,0.00],
 [0.48,0.00,0.00],
 [0.49,0.00,0.00],
 [0.50,0.00,0.00],
 [0.51,0.00,0.00],
 [0.52,0.00,0.00],
 [0.53,0.00,0.00],
 [0.54,0.00,0.00],
 [0.55,0.00,0.00],
 [0.56,0.00,0.00],
 [0.57,0.00,0.00],
 [0.58,0.00,0.00],
 [0.59,0.00,0.00],
 [0.60,0.00,0.00],
 [0.61,0.00,0.00],
 [0.62,0.00,0.00],
 [0.63,0.00,0.00],
 [0.64,0.00,0.00],
 [0.65,0.00,0.00],
 [0.66,0.00,0.00],
 [0.67,0.00,0.00],
 [0.68,0.00,0.00],
 [0.69,0.00,0.00],
 [0.70,0.00,0.00],
 [0.71,0.00,0.00],
 [0.72,0.00,0.00],
 [0.73,0.00,0.00],
 [0.74,0.00,0.00],
 [0.75,0.00,0.00],
 [0.76,0.00,0.00],
 [0.77,0.00,0.00],
 [0.78,0.00,0.00],
 [0.79,0.00,0.00],
 [0.80,0.00,0.00],
 [0.81,0.00,0.00],
 [0.82,0.00,0.00],
 [0.83,0.00,0.00],
 [0.84,0.00,0.00],
 [0.85,0.00,0.00],
 [0.86,0.00,0.00],
 [0.87,0.00,0.00],
 [0.88,0.00,0.00],
 [0.89,0.00,0.00],
 [0.90,0.00,0.00],
 [0.91,0.00,0.00],
 [0.92,0.00,0.00],
 [0.93,0.00,0.00],
 [0.94,0.00,0.00],
 [0.95,0.00,0.00],
 [0.96,0.00,0.00],
 [0.97,0.00,0.00],
 [0.98,0.00,0.00],
 [0.99,0.00,0.00],
 [1.00,0.00,0.00],
 [1.00,0.01,0.00],
 [1.00,0.02,0.00],
 [1.00,0.03,0.00],
 [1.00,0.04,0.00],
 [1.00,0.05,0.00],
 [1.00,0.06,0.00],
 [1.00,0.07,0.00],
 [1.00,0.08,0.00],
 [1.00,0.09,0.00],
 [1.00,0.10,0.00],
 [1.00,0.11,0.00],
 [1.00,0.12,0.00],
 [1.00,0.13,0.00],
 [1.00,0.14,0.00],
 [1.00,0.15,0.00],
 [1.00,0.16,0.00],
 [1.00,0.17,0.00],
 [1.00,0.18,0.00],
 [1.00,0.19,0.00],
 [1.00,0.20,0.00],
 [1.00,0.21,0.00],
 [1.00,0.22,0.00],
 [1.00,0.23,0.00],
 [1.00,0.24,0.00],
 [1.00,0.25,0.00],
 [1.00,0.26,0.00],
 [1.00,0.27,0.00],
 [1.00,0.28,0.00],
 [1.00,0.29,0.00],
 [1.00,0.30,0.00],
 [1.00,0.31,0.00],
 [1.00,0.32,0.00],
 [1.00,0.33,0.00],
 [1.00,0.34,0.00],
 [1.00,0.35,0.00],
 [1.00,0.36,0.00],
 [1.00,0.37,0.00],
 [1.00,0.38,0.00],
 [1.00,0.39,0.00],
 [1.00,0.40,0.00],
 [1.00,0.41,0.00],
 [1.00,0.42,0.00],
 [1.00,0.43,0.00],
 [1.00,0.44,0.00],
 [1.00,0.45,0.00],
 [1.00,0.46,0.00],
 [1.00,0.47,0.00],
 [1.00,0.48,0.00],
 [1.00,0.49,0.00],
 [1.00,0.50,0.00],
 [1.00,0.51,0.00],
 [1.00,0.52,0.00],
 [1.00,0.53,0.00],
 [1.00,0.54,0.00],
 [1.00,0.55,0.00],
 [1.00,0.56,0.00],
 [1.00,0.57,0.00],
 [1.00,0.58,0.00],
 [1.00,0.59,0.00],
 [1.00,0.60,0.00],
 [1.00,0.61,0.00],
 [1.00,0.62,0.00],
 [1.00,0.63,0.00],
 [1.00,0.64,0.00],
 [1.00,0.65,0.00],
 [1.00,0.66,0.00],
 [1.00,0.67,0.00],
 [1.00,0.68,0.00],
 [1.00,0.69,0.00],
 [1.00,0.70,0.00],
 [1.00,0.71,0.00],
 [1.00,0.72,0.00],
 [1.00,0.73,0.00],
 [1.00,0.74,0.00],
 [1.00,0.75,0.00],
 [1.00,0.76,0.00],
 [1.00,0.77,0.00],
 [1.00,0.78,0.00],
 [1.00,0.79,0.00],
 [1.00,0.80,0.00],
 [1.00,0.81,0.00],
 [1.00,0.82,0.00],
 [1.00,0.83,0.00],
 [1.00,0.84,0.00],
 [1.00,0.85,0.00],
 [1.00,0.86,0.00],
 [1.00,0.87,0.00],
 [1.00,0.88,0.00],
 [1.00,0.89,0.00],
 [1.00,0.90,0.00],
 [1.00,0.91,0.00],
 [1.00,0.92,0.00],
 [1.00,0.93,0.00],
 [1.00,0.94,0.00],
 [1.00,0.95,0.00],
 [1.00,0.96,0.00],
 [1.00,0.97,0.00],
 [1.00,0.98,0.00],
 [1.00,0.99,0.00],
 [1.00,1.00,0.00],
 [0.99,1.00,0.00],
 [0.98,1.00,0.00],
 [0.97,1.00,0.00],
 [0.96,1.00,0.00],
 [0.95,1.00,0.00],
 [0.94,1.00,0.00],
 [0.93,1.00,0.00],
 [0.92,1.00,0.00],
 [0.91,1.00,0.00],
 [0.90,1.00,0.00],
 [0.89,1.00,0.00],
 [0.88,1.00,0.00],
 [0.87,1.00,0.00],
 [0.86,1.00,0.00],
 [0.85,1.00,0.00],
 [0.84,1.00,0.00],
 [0.83,1.00,0.00],
 [0.82,1.00,0.00],
 [0.81,1.00,0.00],
 [0.80,1.00,0.00],
 [0.79,1.00,0.00],
 [0.78,1.00,0.00],
 [0.77,1.00,0.00],
 [0.76,1.00,0.00],
 [0.75,1.00,0.00],
 [0.74,1.00,0.00],
 [0.73,1.00,0.00],
 [0.72,1.00,0.00],
 [0.71,1.00,0.00],
 [0.70,1.00,0.00],
 [0.69,1.00,0.00],
 [0.68,1.00,0.00],
 [0.67,1.00,0.00],
 [0.66,1.00,0.00],
 [0.65,1.00,0.00],
 [0.64,1.00,0.00],
 [0.63,1.00,0.00],
 [0.62,1.00,0.00],
 [0.61,1.00,0.00],
 [0.60,1.00,0.00],
 [0.59,1.00,0.00],
 [0.58,1.00,0.00],
 [0.57,1.00,0.00],
 [0.56,1.00,0.00],
 [0.55,1.00,0.00],
 [0.54,1.00,0.00],
 [0.53,1.00,0.00],
 [0.52,1.00,0.00],
 [0.51,1.00,0.00],
 [0.50,1.00,0.00],
 [0.49,1.00,0.00],
 [0.48,1.00,0.00],
 [0.47,1.00,0.00],
 [0.46,1.00,0.00],
 [0.45,1.00,0.00],
 [0.44,1.00,0.00],
 [0.43,1.00,0.00],
 [0.42,1.00,0.00],
 [0.41,1.00,0.00],
 [0.40,1.00,0.00],
 [0.39,1.00,0.00],
 [0.38,1.00,0.00],
 [0.37,1.00,0.00],
 [0.36,1.00,0.00],
 [0.35,1.00,0.00],
 [0.34,1.00,0.00],
 [0.33,1.00,0.00],
 [0.32,1.00,0.00],
 [0.31,1.00,0.00],
 [0.30,1.00,0.00],
 [0.29,1.00,0.00],
 [0.28,1.00,0.00],
 [0.27,1.00,0.00],
 [0.26,1.00,0.00],
 [0.25,1.00,0.00],
 [0.24,1.00,0.00],
 [0.23,1.00,0.00],
 [0.22,1.00,0.00],
 [0.21,1.00,0.00],
 [0.20,1.00,0.00],
 [0.19,1.00,0.00],
 [0.18,1.00,0.00],
 [0.17,1.00,0.00],
 [0.16,1.00,0.00],
 [0.15,1.00,0.00],
 [0.14,1.00,0.00],
 [0.13,1.00,0.00],
 [0.12,1.00,0.00],
 [0.11,1.00,0.00],
 [0.10,1.00,0.00],
 [0.09,1.00,0.00],
 [0.08,1.00,0.00],
 [0.07,1.00,0.00],
 [0.06,1.00,0.00],
 [0.05,1.00,0.00],
 [0.04,1.00,0.00],
 [0.03,1.00,0.00],
 [0.02,1.00,0.00],
 [0.01,1.00,0.00],
 [0.00,1.00,0.00],
 [0.00,0.99,0.00],
 [0.00,0.98,0.00],
 [0.00,0.97,0.00],
 [0.00,0.96,0.00],
 [0.00,0.95,0.00],
 [0.00,0.94,0.00],
 [0.00,0.93,0.00],
 [0.00,0.92,0.00],
 [0.00,0.91,0.00],
 [0.00,0.90,0.00],
 [0.00,0.89,0.00],
 [0.00,0.88,0.00],
 [0.00,0.87,0.00],
 [0.00,0.86,0.00],
 [0.00,0.85,0.00],
 [0.00,0.84,0.00],
 [0.00,0.83,0.00],
 [0.00,0.82,0.00],
 [0.00,0.81,0.00],
 [0.00,0.80,0.00],
 [0.00,0.79,0.00],
 [0.00,0.78,0.00],
 [0.00,0.77,0.00],
 [0.00,0.76,0.00],
 [0.00,0.75,0.00],
 [0.00,0.74,0.00],
 [0.00,0.73,0.00],
 [0.00,0.72,0.00],
 [0.00,0.71,0.00],
 [0.00,0.70,0.00],
 [0.00,0.69,0.00],
 [0.00,0.68,0.00],
 [0.00,0.67,0.00],
 [0.00,0.66,0.00],
 [0.00,0.65,0.00],
 [0.00,0.64,0.00],
 [0.00,0.63,0.00],
 [0.00,0.62,0.00],
 [0.00,0.61,0.00],
 [0.00,0.60,0.00],
 [0.00,0.59,0.00],
 [0.00,0.58,0.00],
 [0.00,0.57,0.00],
 [0.00,0.56,0.00],
 [0.00,0.55,0.00],
 [0.00,0.54,0.00],
 [0.00,0.53,0.00],
 [0.00,0.52,0.00],
 [0.00,0.51,0.00],
 [0.00,0.50,0.00],
 [0.00,0.49,0.00],
 [0.00,0.48,0.00],
 [0.00,0.47,0.00],
 [0.00,0.46,0.00],
 [0.00,0.45,0.00],
 [0.00,0.44,0.00],
 [0.00,0.43,0.00],
 [0.00,0.42,0.00],
 [0.00,0.41,0.00],
 [0.00,0.40,0.00],
 [0.00,0.39,0.00],
 [0.00,0.38,0.00],
 [0.00,0.37,0.00],
 [0.00,0.36,0.00],
 [0.00,0.35,0.00],
 [0.00,0.34,0.00],
 [0.00,0.33,0.00],
 [0.00,0.32,0.00],
 [0.00,0.31,0.00],
 [0.00,0.30,0.00],
 [0.00,0.29,0.00],
 [0.00,0.28,0.00],
 [0.00,0.27,0.00],
 [0.00,0.26,0.00],
 [0.00,0.25,0.00],
 [0.00,0.24,0.00],
 [0.00,0.23,0.00],
 [0.00,0.22,0.00],
 [0.00,0.21,0.00],
 [0.00,0.20,0.00],
 [0.00,0.19,0.00],
 [0.00,0.18,0.00],
 [0.00,0.17,0.00],
 [0.00,0.16,0.00],
 [0.00,0.15,0.00],
 [0.00,0.14,0.00],
 [0.00,0.13,0.00],
 [0.00,0.12,0.00],
 [0.00,0.11,0.00],
 [0.00,0.10,0.00],
 [0.00,0.09,0.00],
 [0.00,0.08,0.00],
 [0.00,0.07,0.00],
 [0.00,0.06,0.00],
 [0.00,0.05,0.00],
 [0.00,0.04,0.00],
 [0.00,0.03,0.00],
 [0.00,0.02,0.00],
 [0.00,0.01,0.00]])
 
Dom0 = geom.add_polygon(FrameCoordinates,cl,make_surface=True);
 
# Define coordinates of Inner Domain 
PolCoordinates1= np.array([[0.,1.,0.],
 [0.,0.,0.],
 [1.,0.,0.],
 [1.,1.,0.]])
 
Dom1= geom.add_polygon(PolCoordinates1,cl,make_surface=True);
 
geom.boolean_fragments([Dom0],[Dom1])

geom.add_raw_code("Mesh.SaveElementTagType=2;")

# Get the next available surface tag
geom.add_raw_code("LastSurf = news;")

# Rename surfaces resulting from Boolean operation(s) to ss
geom.add_raw_code("ss[] = Surface '*';")

geom.add_raw_code("Physical Surface(1) = {LastSurf-#ss[]+1:LastSurf-1};")

geom.add_raw_code("Physical Surface(2) ={s1};")

msh = pygmsh.generate_mesh(geom, geo_filename = "Image75240.msh", prune_z_0=True)

tri_cells = np.array([None])
for cell in msh.cells:
   if cell.type == "triangle":
        # Collect the individual meshes
        if tri_cells.all() == None:
            tri_cells = cell.data
        else:
             tri_cells = np.concatenate((tri_cells, cell.data))

tri_data = None
for key in msh.cell_data_dict["gmsh:physical"].keys():
    if key == "triangle":
       tri_data = msh.cell_data_dict["gmsh:physical"][key]
 # Create triangular mesh with cell data attached
tri_mesh = meshio.Mesh(points=msh.points, cells={"triangle": tri_cells},
                           cell_data={"SurfaceRegions":[tri_data]})

meshio.write("Image75240.xdmf",tri_mesh)
